list:
  get:
    tags: [Snapshots]
    summary: List strategy snapshots
    description: |
      Returns paginated snapshots for a given strategy, ordered by `created_at` descending.
      Optionally filter by `account_id`.

      **Permissions:** `root` only
    parameters:
      - name: strategy_id
        in: query
        required: true
        schema:
          type: string
          format: uuid
        description: The strategy ID to retrieve snapshots for.
      - name: account_id
        in: query
        required: false
        schema:
          type: integer
        description: Optional account ID filter.
      - name: page
        in: query
        required: false
        schema:
          type: integer
          minimum: 1
          default: 1
        description: Page number.
      - name: per_page
        in: query
        required: false
        schema:
          type: integer
          minimum: 1
          maximum: 100
          default: 50
        description: Number of items per page.
    responses:
      "200":
        description: List of strategy snapshots
        content:
          application/json:
            example:
              success: true
              data:
                - id: "6789abcdef012345"
                  account_id: 12345678
                  strategy_id: "550e8400-e29b-41d4-a716-446655440000"
                  nav: 5250.0
                  drawdown_pct: 1.25
                  daily_pnl: 75.0
                  floating_pnl: 50.0
                  open_order_count: 2
                  exposure_lots: 0.2
                  created_at: "2026-01-15T10:30:00+00:00"
              meta:
                count: 1
                pagination:
                  total: 50
                  page: 1
                  per_page: 50
                  total_pages: 1
      "400":
        description: Missing or invalid strategy_id
      "403":
        description: Insufficient permissions (non-root user)

store:
  post:
    tags: [Snapshots]
    summary: Store strategy snapshot
    description: |
      Records a point-in-time snapshot of a strategy's performance.
      Used for historical tracking and analytics.

      **Permissions:** `root` or `producer`
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: "../components/schemas.yaml#/CreateStrategySnapshotRequest"
          example:
            account_id: 12345678
            strategy_id: "550e8400-e29b-41d4-a716-446655440000"
            nav: 5250.00
            drawdown_pct: 1.2500
            daily_pnl: 75.00
            floating_pnl: 50.00
            open_order_count: 2
            exposure_lots: 0.20
    responses:
      "201":
        description: Snapshot recorded
        content:
          application/json:
            example:
              success: true
      "403":
        description: Account belongs to another user
