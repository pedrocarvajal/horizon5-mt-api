list:
  get:
    tags: [Strategies]
    summary: List all strategies
    description: |
      Returns all trading strategies in the system.

      **Permissions:** `root` only
    responses:
      "200":
        description: List of strategies
        content:
          application/json:
            example:
              success: true
              data:
                - id: "550e8400-e29b-41d4-a716-446655440000"
                  account_id: 12345678
                  symbol: "EURUSD"
                  prefix: "EU"
                  name: "Euro Scalper v2"
                  magic_number: 100001
                  balance: "5000.00"
                  created_at: "2026-01-15T10:30:00+00:00"
                  updated_at: "2026-01-15T12:00:00+00:00"
              meta:
                count: 1
      "403":
        description: Insufficient permissions (non-root user)

upsert:
  post:
    tags: [Strategies]
    summary: Upsert strategy
    description: |
      Creates or updates a trading strategy. The strategy is linked to an account
      owned by the authenticated user.

      If a strategy with the given `id` already exists and its account belongs to
      the authenticated user, it is updated. Otherwise, a new strategy is created.

      **Permissions:** `root` or `producer`
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: "../components/schemas.yaml#/UpsertStrategyRequest"
          example:
            id: "550e8400-e29b-41d4-a716-446655440000"
            account_id: 12345678
            symbol: "EURUSD"
            prefix: "EU"
            name: "Euro Scalper v2"
            magic_number: 100001
            balance: 5000.00
    responses:
      "201":
        description: Strategy created
        content:
          application/json:
            example:
              success: true
              data:
                id: "550e8400-e29b-41d4-a716-446655440000"
      "200":
        description: Strategy updated
        content:
          application/json:
            example:
              success: true
              data:
                id: "550e8400-e29b-41d4-a716-446655440000"
      "403":
        description: Account or strategy belongs to another user
